\hypertarget{namespacepwp__msg}{}\section{pwp\+\_\+msg Namespace Reference}
\label{namespacepwp__msg}\index{pwp\+\_\+msg@{pwp\+\_\+msg}}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1daf}{msg\+\_\+id} \{ \newline
\hyperlink{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafae1d8b3754d66ec7fcad827fb54eaeea2}{chocked} = 0x00, 
\hyperlink{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafa55689e288bf71e7737faaf385b1c528b}{unchocked} = 0x01, 
\hyperlink{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafaa20400a601bcf2b8d752b26376b2b904}{interested} = 0x02, 
\hyperlink{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafa3150be15265845a6442c6ecd1515ecec}{not\+\_\+interested} = 0x03, 
\newline
{\bfseries have} = 0x04, 
\hyperlink{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafac3a2343a7b67a371e241ae2184bfe9cd}{bitfield} = 0x05, 
\hyperlink{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafa4d6478c4fe948a9f3aa3ce8d09974370}{request} = 0x06, 
{\bfseries piece} = 0x07, 
\newline
{\bfseries cancel} = 0x08, 
{\bfseries port} = 0x09
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{namespacepwp__msg_a9a577f5a53b823d83bb4694f1ebf141e}{send\+\_\+keep\+\_\+alive} (const \hyperlink{structpwp_1_1peer__connection}{pwp\+::peer\+\_\+connection} \&peer\+\_\+c, boost\+::asio\+::deadline\+\_\+timer \&timer)
\item 
void \hyperlink{namespacepwp__msg_a30c14bc06a8bb851ca79781cb9686b4f}{enable\+\_\+keep\+\_\+alive\+\_\+message} (\hyperlink{structpwp_1_1peer__connection}{pwp\+::peer\+\_\+connection} \&peer\+\_\+c)
\item 
int \hyperlink{namespacepwp__msg_aca807c6281879abef952f8feecccb6e8}{send\+\_\+msg} (\hyperlink{structpwp_1_1peer__connection}{pwp\+::peer\+\_\+connection} \&peer\+\_\+c, std\+::vector$<$ uint8\+\_\+t $>$ msg)
\begin{DoxyCompactList}\small\item\em Send {\ttfamily msg} to the peer specified in {\ttfamily peer\+\_\+c} \end{DoxyCompactList}\item 
\mbox{\Hypertarget{namespacepwp__msg_a529a3db7938ccfaab85579d58e24061e}\label{namespacepwp__msg_a529a3db7938ccfaab85579d58e24061e}} 
std\+::vector$<$ uint8\+\_\+t $>$ {\bfseries craft\+\_\+have\+\_\+msg} (int piece\+\_\+index)
\item 
\mbox{\Hypertarget{namespacepwp__msg_a2dcbe5fbe0eeca8910340f4978ee4235}\label{namespacepwp__msg_a2dcbe5fbe0eeca8910340f4978ee4235}} 
std\+::vector$<$ uint8\+\_\+t $>$ {\bfseries make\+\_\+request\+\_\+msg} (\hyperlink{structRequestMsg}{Request\+Msg} \hyperlink{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafa4d6478c4fe948a9f3aa3ce8d09974370}{request})
\item 
\mbox{\Hypertarget{namespacepwp__msg_aa9cc2ccac70638ed59075f27f938b8ec}\label{namespacepwp__msg_aa9cc2ccac70638ed59075f27f938b8ec}} 
int {\bfseries get\+\_\+bitfield} (\hyperlink{structpwp_1_1peer__connection}{pwp\+::peer\+\_\+connection} \&peer\+\_\+c, \hyperlink{structTorrent}{Torrent} \&torrent)
\item 
void \hyperlink{namespacepwp__msg_aec35de04a2f2d9cb6abdd777917cfaae}{read\+\_\+msg\+\_\+handler} (std\+::vector$<$ uint8\+\_\+t $>$ \&response, \hyperlink{structpwp_1_1peer__connection}{pwp\+::peer\+\_\+connection} \&peer\+\_\+c, \hyperlink{structTorrent}{Torrent} \&torrent, bool \&dead\+\_\+peer, boost\+::asio\+::deadline\+\_\+timer \&timer\+\_\+, const boost\+::system\+::error\+\_\+code \&error, size\+\_\+t bytes\+\_\+read)
\begin{DoxyCompactList}\small\item\em The handler of the message for the P\+WP protocol. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{namespacepwp__msg_ab578b213d293636d33efc24382f16b25}\label{namespacepwp__msg_ab578b213d293636d33efc24382f16b25}} 
int {\bfseries sender} (\hyperlink{structpwp_1_1peer__connection}{pwp\+::peer\+\_\+connection} \&peer\+\_\+conn, \hyperlink{structTorrent}{Torrent} \&torrent, int \&old\+\_\+begin)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{namespacepwp__msg_ae962e65b1871714756b6aeb4722a8caf}\label{namespacepwp__msg_ae962e65b1871714756b6aeb4722a8caf}} 
enum \hyperlink{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1daf}{pwp\+\_\+msg\+::msg\+\_\+id} {\bfseries Peer\+List}
\item 
const std\+::vector$<$ uint8\+\_\+t $>$ \hyperlink{namespacepwp__msg_a695ee2efb59a7c258559f19440fe6998}{choke\+\_\+msg} = \{0,0,0,1,0\}
\item 
const std\+::vector$<$ uint8\+\_\+t $>$ \hyperlink{namespacepwp__msg_acdc5eb698534e84a15db0e061c511e7c}{unchoke\+\_\+msg} = \{0,0,0,1,1\}
\item 
const std\+::vector$<$ uint8\+\_\+t $>$ \hyperlink{namespacepwp__msg_afc68b17ce131c52fa0beb0cc7185778b}{interested\+\_\+msg} = \{0,0,0,1,2\}
\item 
const std\+::vector$<$ uint8\+\_\+t $>$ \hyperlink{namespacepwp__msg_a16a5f22f784d872342a82af9f6b77830}{non\+\_\+interested\+\_\+msg} = \{0,0,0,1,3\}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
This namespace contains all the function that are related to the messages of the P\+WP Protocol 

\subsection{Enumeration Type Documentation}
\mbox{\Hypertarget{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1daf}\label{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1daf}} 
\index{pwp\+\_\+msg@{pwp\+\_\+msg}!msg\+\_\+id@{msg\+\_\+id}}
\index{msg\+\_\+id@{msg\+\_\+id}!pwp\+\_\+msg@{pwp\+\_\+msg}}
\subsubsection{\texorpdfstring{msg\+\_\+id}{msg\_id}}
{\footnotesize\ttfamily enum \hyperlink{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1daf}{pwp\+\_\+msg\+::msg\+\_\+id}}

P\+WP Message ID \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{chocked@{chocked}!pwp\+\_\+msg@{pwp\+\_\+msg}}\index{pwp\+\_\+msg@{pwp\+\_\+msg}!chocked@{chocked}}}\mbox{\Hypertarget{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafae1d8b3754d66ec7fcad827fb54eaeea2}\label{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafae1d8b3754d66ec7fcad827fb54eaeea2}} 
chocked&Set the chocked state \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{unchocked@{unchocked}!pwp\+\_\+msg@{pwp\+\_\+msg}}\index{pwp\+\_\+msg@{pwp\+\_\+msg}!unchocked@{unchocked}}}\mbox{\Hypertarget{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafa55689e288bf71e7737faaf385b1c528b}\label{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafa55689e288bf71e7737faaf385b1c528b}} 
unchocked&Set the unchocked state \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{interested@{interested}!pwp\+\_\+msg@{pwp\+\_\+msg}}\index{pwp\+\_\+msg@{pwp\+\_\+msg}!interested@{interested}}}\mbox{\Hypertarget{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafaa20400a601bcf2b8d752b26376b2b904}\label{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafaa20400a601bcf2b8d752b26376b2b904}} 
interested&Set the interested state \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{not\+\_\+interested@{not\+\_\+interested}!pwp\+\_\+msg@{pwp\+\_\+msg}}\index{pwp\+\_\+msg@{pwp\+\_\+msg}!not\+\_\+interested@{not\+\_\+interested}}}\mbox{\Hypertarget{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafa3150be15265845a6442c6ecd1515ecec}\label{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafa3150be15265845a6442c6ecd1515ecec}} 
not\+\_\+interested&Set the not interested state \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{bitfield@{bitfield}!pwp\+\_\+msg@{pwp\+\_\+msg}}\index{pwp\+\_\+msg@{pwp\+\_\+msg}!bitfield@{bitfield}}}\mbox{\Hypertarget{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafac3a2343a7b67a371e241ae2184bfe9cd}\label{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafac3a2343a7b67a371e241ae2184bfe9cd}} 
bitfield&Bitfield sended/received \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{request@{request}!pwp\+\_\+msg@{pwp\+\_\+msg}}\index{pwp\+\_\+msg@{pwp\+\_\+msg}!request@{request}}}\mbox{\Hypertarget{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafa4d6478c4fe948a9f3aa3ce8d09974370}\label{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1dafa4d6478c4fe948a9f3aa3ce8d09974370}} 
request&Request a piece \\
\hline

\end{DoxyEnumFields}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespacepwp__msg_a30c14bc06a8bb851ca79781cb9686b4f}\label{namespacepwp__msg_a30c14bc06a8bb851ca79781cb9686b4f}} 
\index{pwp\+\_\+msg@{pwp\+\_\+msg}!enable\+\_\+keep\+\_\+alive\+\_\+message@{enable\+\_\+keep\+\_\+alive\+\_\+message}}
\index{enable\+\_\+keep\+\_\+alive\+\_\+message@{enable\+\_\+keep\+\_\+alive\+\_\+message}!pwp\+\_\+msg@{pwp\+\_\+msg}}
\subsubsection{\texorpdfstring{enable\+\_\+keep\+\_\+alive\+\_\+message()}{enable\_keep\_alive\_message()}}
{\footnotesize\ttfamily void pwp\+\_\+msg\+::enable\+\_\+keep\+\_\+alive\+\_\+message (\begin{DoxyParamCaption}\item[{\hyperlink{structpwp_1_1peer__connection}{pwp\+::peer\+\_\+connection} \&}]{peer\+\_\+c }\end{DoxyParamCaption})}

Start the timer that each K\+E\+E\+P\+\_\+\+A\+L\+I\+V\+E\+\_\+\+T\+I\+ME send a Keep-\/alive request


\begin{DoxyParams}{Parameters}
{\em peer\+\_\+c} & The peer\textquotesingle{}s connection structure \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacepwp__msg_aec35de04a2f2d9cb6abdd777917cfaae}\label{namespacepwp__msg_aec35de04a2f2d9cb6abdd777917cfaae}} 
\index{pwp\+\_\+msg@{pwp\+\_\+msg}!read\+\_\+msg\+\_\+handler@{read\+\_\+msg\+\_\+handler}}
\index{read\+\_\+msg\+\_\+handler@{read\+\_\+msg\+\_\+handler}!pwp\+\_\+msg@{pwp\+\_\+msg}}
\subsubsection{\texorpdfstring{read\+\_\+msg\+\_\+handler()}{read\_msg\_handler()}}
{\footnotesize\ttfamily void pwp\+\_\+msg\+::read\+\_\+msg\+\_\+handler (\begin{DoxyParamCaption}\item[{std\+::vector$<$ uint8\+\_\+t $>$ \&}]{response,  }\item[{\hyperlink{structpwp_1_1peer__connection}{pwp\+::peer\+\_\+connection} \&}]{peer\+\_\+c,  }\item[{\hyperlink{structTorrent}{Torrent} \&}]{torrent,  }\item[{bool \&}]{dead\+\_\+peer,  }\item[{boost\+::asio\+::deadline\+\_\+timer \&}]{timer\+\_\+,  }\item[{const boost\+::system\+::error\+\_\+code \&}]{error,  }\item[{size\+\_\+t}]{bytes\+\_\+read }\end{DoxyParamCaption})}



The handler of the message for the P\+WP protocol. 

Initially the message length is readed and next the corresponding byte are readed from the socket stream. Then the message ID is parsed and the appropriate action is taken

See \mbox{[}\hyperlink{namespacepwp__msg_a0b9a29508f00a30e5138d2b78f4b1daf}{pwp\+\_\+msg\+::msg\+\_\+id}\mbox{]} for message types


\begin{DoxyParams}{Parameters}
{\em response} & The response received \\
\hline
{\em peer\+\_\+c} & The peer\+\_\+connection who received the response \\
\hline
{\em torrent} & The torrent structure \\
\hline
{\em dead\+\_\+peer} & Reference to a flag to set if the peer is death \\
\hline
{\em timer\+\_\+} & Reference of the timer that call the ???? Really necessary? \\
\hline
{\em error} & Socket error \\
\hline
{\em bytes\+\_\+read} & \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacepwp__msg_a9a577f5a53b823d83bb4694f1ebf141e}\label{namespacepwp__msg_a9a577f5a53b823d83bb4694f1ebf141e}} 
\index{pwp\+\_\+msg@{pwp\+\_\+msg}!send\+\_\+keep\+\_\+alive@{send\+\_\+keep\+\_\+alive}}
\index{send\+\_\+keep\+\_\+alive@{send\+\_\+keep\+\_\+alive}!pwp\+\_\+msg@{pwp\+\_\+msg}}
\subsubsection{\texorpdfstring{send\+\_\+keep\+\_\+alive()}{send\_keep\_alive()}}
{\footnotesize\ttfamily void pwp\+\_\+msg\+::send\+\_\+keep\+\_\+alive (\begin{DoxyParamCaption}\item[{const \hyperlink{structpwp_1_1peer__connection}{pwp\+::peer\+\_\+connection} \&}]{peer\+\_\+c,  }\item[{boost\+::asio\+::deadline\+\_\+timer \&}]{timer }\end{DoxyParamCaption})}

Handler that is executed every K\+E\+E\+P\+\_\+\+A\+L\+I\+V\+E\+\_\+\+T\+I\+ME and send a keep-\/alive message.

If the peer\+\_\+c\textquotesingle{}s socket is closed, then the periodic routine is stopped by calling.~\newline
 {\ttfamily timer.\+cancel()} So the handler is calcelled from \hyperlink{pwp_8hpp_a7efe93eb3d4e0f0c9ab96fa5ae443fcd}{\+\_\+io\+\_\+service}


\begin{DoxyParams}{Parameters}
{\em peer\+\_\+c} & The peer connection structure. \\
\hline
{\em timer} & The deadline\+\_\+timer that call the handler. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacepwp__msg_aca807c6281879abef952f8feecccb6e8}\label{namespacepwp__msg_aca807c6281879abef952f8feecccb6e8}} 
\index{pwp\+\_\+msg@{pwp\+\_\+msg}!send\+\_\+msg@{send\+\_\+msg}}
\index{send\+\_\+msg@{send\+\_\+msg}!pwp\+\_\+msg@{pwp\+\_\+msg}}
\subsubsection{\texorpdfstring{send\+\_\+msg()}{send\_msg()}}
{\footnotesize\ttfamily int pwp\+\_\+msg\+::send\+\_\+msg (\begin{DoxyParamCaption}\item[{\hyperlink{structpwp_1_1peer__connection}{pwp\+::peer\+\_\+connection} \&}]{peer\+\_\+c,  }\item[{std\+::vector$<$ uint8\+\_\+t $>$}]{msg }\end{DoxyParamCaption})}



Send {\ttfamily msg} to the peer specified in {\ttfamily peer\+\_\+c} 

Error code list

\tabulinesep=1mm
\begin{longtabu} spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Error Code }&\textbf{ Explaination  }\\\cline{1-2}
\endfirsthead
\hline
\endfoot
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Error Code }&\textbf{ Explaination  }\\\cline{1-2}
\endhead
-\/1 &Invalid Address \\\cline{1-2}
-\/2 &Cannot open socket \\\cline{1-2}
-\/3 &Connection closed \\\cline{1-2}
-\/4 &Exception (see the output) \\\cline{1-2}
\end{longtabu}

\begin{DoxyParams}{Parameters}
{\em peer\+\_\+c} & \hyperlink{classPeer}{Peer} connection structure \\
\hline
{\em msg} & Message to send \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, $<$0 otherwise 
\end{DoxyReturn}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespacepwp__msg_a695ee2efb59a7c258559f19440fe6998}\label{namespacepwp__msg_a695ee2efb59a7c258559f19440fe6998}} 
\index{pwp\+\_\+msg@{pwp\+\_\+msg}!choke\+\_\+msg@{choke\+\_\+msg}}
\index{choke\+\_\+msg@{choke\+\_\+msg}!pwp\+\_\+msg@{pwp\+\_\+msg}}
\subsubsection{\texorpdfstring{choke\+\_\+msg}{choke\_msg}}
{\footnotesize\ttfamily const std\+::vector$<$uint8\+\_\+t$>$ pwp\+\_\+msg\+::choke\+\_\+msg = \{0,0,0,1,0\}}

Default chocked message \mbox{\Hypertarget{namespacepwp__msg_afc68b17ce131c52fa0beb0cc7185778b}\label{namespacepwp__msg_afc68b17ce131c52fa0beb0cc7185778b}} 
\index{pwp\+\_\+msg@{pwp\+\_\+msg}!interested\+\_\+msg@{interested\+\_\+msg}}
\index{interested\+\_\+msg@{interested\+\_\+msg}!pwp\+\_\+msg@{pwp\+\_\+msg}}
\subsubsection{\texorpdfstring{interested\+\_\+msg}{interested\_msg}}
{\footnotesize\ttfamily const std\+::vector$<$uint8\+\_\+t$>$ pwp\+\_\+msg\+::interested\+\_\+msg = \{0,0,0,1,2\}}

Default interested message \mbox{\Hypertarget{namespacepwp__msg_a16a5f22f784d872342a82af9f6b77830}\label{namespacepwp__msg_a16a5f22f784d872342a82af9f6b77830}} 
\index{pwp\+\_\+msg@{pwp\+\_\+msg}!non\+\_\+interested\+\_\+msg@{non\+\_\+interested\+\_\+msg}}
\index{non\+\_\+interested\+\_\+msg@{non\+\_\+interested\+\_\+msg}!pwp\+\_\+msg@{pwp\+\_\+msg}}
\subsubsection{\texorpdfstring{non\+\_\+interested\+\_\+msg}{non\_interested\_msg}}
{\footnotesize\ttfamily const std\+::vector$<$uint8\+\_\+t$>$ pwp\+\_\+msg\+::non\+\_\+interested\+\_\+msg = \{0,0,0,1,3\}}

Default non interested message \mbox{\Hypertarget{namespacepwp__msg_acdc5eb698534e84a15db0e061c511e7c}\label{namespacepwp__msg_acdc5eb698534e84a15db0e061c511e7c}} 
\index{pwp\+\_\+msg@{pwp\+\_\+msg}!unchoke\+\_\+msg@{unchoke\+\_\+msg}}
\index{unchoke\+\_\+msg@{unchoke\+\_\+msg}!pwp\+\_\+msg@{pwp\+\_\+msg}}
\subsubsection{\texorpdfstring{unchoke\+\_\+msg}{unchoke\_msg}}
{\footnotesize\ttfamily const std\+::vector$<$uint8\+\_\+t$>$ pwp\+\_\+msg\+::unchoke\+\_\+msg = \{0,0,0,1,1\}}

Default unchocked message 